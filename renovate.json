{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:base"],
  "enabledManagers": ["kubernetes", "github-actions", "regex"],
  "regexManagers": [
    {
      "fileMatch": ["(^|/).*\\.ya?ml$"],
      "matchStrings": [
        "image:\\s(?<depName>\\S+?)(?::(?<currentValue>\\S+))?$",
        "image:\\s?\"(?<depName>\\S+?):(?<currentValue>\\S+?)\"",
        "image:\\s?'(?<depName>\\S+?):(?<currentValue>\\S+?)'"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "{{depName}}"
    }
  ],
  "packageRules": [
    {
      "matchManagers": ["kubernetes", "regex"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true,
      "automergeType": "branch"
    },
    {
      "matchManagers": ["github-actions"],
      "automerge": true
    },
    {
      "matchPaths": ["apps/**", "clusters/**", "infra/**", "controllers/**"],
      "groupName": "k8s-manifests",
      "commitMessageTopic": "k8s manifests"
    }
  ],
  "ignorePaths": ["**/*.sops.yaml", ".sops.yaml"]
}